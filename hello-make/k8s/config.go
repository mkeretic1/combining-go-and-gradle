package k8s

import (
	"encoding/base64"
	"fmt"
	"k8s.io/client-go/kubernetes"
	"k8s.io/client-go/rest"
)

func GetClientSet() (*kubernetes.Clientset, error) {
	ca, caErr := decodeString("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyTmpnMk1EUTNNRE13SGhjTk1qSXhNVEUyTVRNeE9ESXpXaGNOTXpJeE1URXpNVE14T0RJegpXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyTmpnMk1EUTNNRE13V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFSa0hjNER3S3YwczlkY0c4TlMxYlVLK1VlLzNidWhSUHhVNHFMMkthNGsKY0MwWGlDaUNBT2pXZWhnYmlNdmtvSk5iYlpCOFpFSXljM29VMWFrN01vanpvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVWVOYUpRdmRPSzFwL1FaTFM5WFdFClY1cjByTmN3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUloQU93VndhbS9QTGlWa2ovZ1JkZzFhQUdETGZNWXd0eXkKNVE1YlkybDlSS0h6QWlBUU0yK3EvN3hKRHFkMmRlTFMxTmRiUW44RTBiTkxmVEtxRDNqaWpFRlRaQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K")
	clientCrt, clientCrtErr := decodeString("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrVENDQVRlZ0F3SUJBZ0lJUm9wbmMwY3FxbTR3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOalk0TmpBME56QXpNQjRYRFRJeU1URXhOakV6TVRneU0xb1hEVEl6TVRFeApOakV6TVRneU0xb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJPNUxuU2RiM09sd1UzdkYKSDgwZzhBdFVaVnpkM2tsR0dHUEJoczVaNFI3akQvNHB4ZkdiZlpEaVhZdFU0MXcxNkVMRWVZL0owTXdRVGpLQQp3Z3BrLzFTalNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCUU9HRno5WVptQm9CQW54MXpiNGxsWmFoK1ErakFLQmdncWhrak9QUVFEQWdOSUFEQkYKQWlFQWxmeEtFd2dYbk43TzZrQXN2dzZHOGc4RkhZdnlzTFRtL1VEUXE2L0s2andDSUg5WDNENmtQaVBQK3VnSgpwazE1T0Jrb3diczNqOTlpa3JkdEliYWU0U2ZYCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlRENDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUyTmpnMk1EUTNNRE13SGhjTk1qSXhNVEUyTVRNeE9ESXpXaGNOTXpJeE1URXpNVE14T0RJegpXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUyTmpnMk1EUTNNRE13V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFTa3NTSHhtcWZ3dzFkZjA1eWh1dGpXRXhxOExuWmxBU2pWMGFPRkh6T08KbnYzbFlBUnN3QUVyZnRpTEYxbnI1dUJJK2RBOWh0b3dMOTJKVHE0Ky9UaFZvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVURoaGMvV0daZ2FBUUo4ZGMyK0paCldXb2ZrUG93Q2dZSUtvWkl6ajBFQXdJRFNRQXdSZ0loQUo1Njgrc3pOQ2xNdE85NFg4cm9GbmdoV2p2QXc0cmUKUVRRT0liYzFzK1gwQWlFQXlFdk1YdUtiT3ZSVGhyTHhNZGVodVJXbDdZN2s1WUlHcElEbU5jMkNyUjg9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K")
	clientKey, clientKeyErr := decodeString("LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUJ5TTAxY29meDNFa0YxM0FhVmxsVUs1WFQ4akNZZjJ3MXE0bXZuSSt3OTRvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFN2t1ZEoxdmM2WEJUZThVZnpTRHdDMVJsWE4zZVNVWVlZOEdHemxuaEh1TVAvaW5GOFp0OQprT0pkaTFUalhEWG9Rc1I1ajhuUXpCQk9Nb0RDQ21UL1ZBPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=")

	if clientCrtErr != nil || clientKeyErr != nil || caErr != nil {
		fmt.Println(clientCrtErr, clientKeyErr, caErr)
	}

	config := &rest.Config{
		Host: "https://0.0.0.0:32815",
		TLSClientConfig: rest.TLSClientConfig{
			CAData:   ca,
			CertData: clientCrt,
			KeyData:  clientKey,
		},
	}

	return kubernetes.NewForConfig(config)
}

func decodeString(val string) ([]byte, error) {
	return base64.StdEncoding.DecodeString(val)
}
