package k8s

import (
	"encoding/base64"
	"fmt"
	"k8s.io/client-go/kubernetes"
	"k8s.io/client-go/rest"
)

func GetClientSet() (*kubernetes.Clientset, error) {
	ca, caErr := decodeString("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkakNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyTmpnd056VTVNakF3SGhjTk1qSXhNVEV3TVRBeU5USXdXaGNOTXpJeE1UQTNNVEF5TlRJdwpXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyTmpnd056VTVNakF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFTc3MwZUU2Q1B0RU16RTd3S2ZMeWo5VzdnZEkvakwrTzFFcXdXdUR3USsKMTZxbDRKRGZ6NTBTcC9SbW5NZU5BOHArK0VIZW00cmNlOFhrQVcvV1dxZEpvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVWFpMGNXU3FnR00yVGY4RytzcUoxCjhaSDJIU0F3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnR3RJWFFnVHV6S0RoRzcxcUJlb1QrM0w5U0RRcXUyQjQKdjJvQXpRU2F6a1lDSURtalhKdExUUGZTdERJVnRSUFZmQW5UejBhWWtYY201MXZRc01BZGgrdVYKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=")
	clientCrt, clientCrtErr := decodeString("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrRENDQVRlZ0F3SUJBZ0lJTjhDRm5COUZnR1F3Q2dZSUtvWkl6ajBFQXdJd0l6RWhNQjhHQTFVRUF3d1kKYXpOekxXTnNhV1Z1ZEMxallVQXhOalk0TURjMU9USXdNQjRYRFRJeU1URXhNREV3TWpVeU1Gb1hEVEl6TVRFeApNREV3TWpVeU1Gb3dNREVYTUJVR0ExVUVDaE1PYzNsemRHVnRPbTFoYzNSbGNuTXhGVEFUQmdOVkJBTVRESE41CmMzUmxiVHBoWkcxcGJqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJQUEdUdmdXVWUyVzJJTGQKU1l2VmhBTEFzdkhGL1NiZytKS2JxYnI5eCt2bUJ1ek5wdjNNbnowaFhjK3BXNDExUDc0djdPV2RlQWFHK0M4TQoxZWozbm5HalNEQkdNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBakFmCkJnTlZIU01FR0RBV2dCUThMUUFnWjhWL1JpbFc4OU05ZmZUYk1JSEdBakFLQmdncWhrak9QUVFEQWdOSEFEQkUKQWlBdEV5VkNYNW5idXR5R3p0OG1veUt0K2krNU5NZ21xTTVoT2NZQWRwRXlnQUlnUjFoRWUyN2hFbHRUbCtiZgpkZHllUnJNY0NoM2MraVBzVzdWb2FJa0hJVGM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkakNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdFkyeHAKWlc1MExXTmhRREUyTmpnd056VTVNakF3SGhjTk1qSXhNVEV3TVRBeU5USXdXaGNOTXpJeE1UQTNNVEF5TlRJdwpXakFqTVNFd0h3WURWUVFEREJock0zTXRZMnhwWlc1MExXTmhRREUyTmpnd056VTVNakF3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFTb2J1bTVxMXFXMWYvdkMvNk9zSkZlSW5nNm82OEgyYUJnYjI5cEp3OXoKMUpzMTZHaHJlN3NzQ3JKazM0Vm42Q2RBcUJ0bU5MK0J0aUpCenJxUWNmdHZvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVBDMEFJR2ZGZjBZcFZ2UFRQWDMwCjJ6Q0J4Z0l3Q2dZSUtvWkl6ajBFQXdJRFJ3QXdSQUlnRXdDdkZPQkdQM2ttMW1ndmxBY2lXVTJNdm03V0d1VDgKTnR3K3REd2FmOW9DSUFraWpHUXJjcHNFbHhmZjRqU1dHLzNBRFhMWGVxQkgxTmdzeTk1OWNEUEcKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=")
	clientKey, clientKeyErr := decodeString("LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUhpR1JuRXo3a3JyV295bWNiQXZCdlVmZEtteFUySkVRN1FRYitpZUN1anZvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFODhaTytCWlI3WmJZZ3QxSmk5V0VBc0N5OGNYOUp1RDRrcHVwdXYzSDYrWUc3TTJtL2N5ZgpQU0ZkejZsYmpYVS92aS9zNVoxNEJvYjRMd3pWNlBlZWNRPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=")

	if clientCrtErr != nil || clientKeyErr != nil || caErr != nil {
		fmt.Println(clientCrtErr, clientKeyErr, caErr)
	}

	config := &rest.Config{
		Host: "https://localhost:32957",
		TLSClientConfig: rest.TLSClientConfig{
			CAData:   ca,
			CertData: clientCrt,
			KeyData:  clientKey,
		},
	}

	return kubernetes.NewForConfig(config)
}

func decodeString(val string) ([]byte, error) {
	return base64.StdEncoding.DecodeString(val)
}
